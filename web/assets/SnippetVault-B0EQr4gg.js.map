{"version":3,"file":"SnippetVault-B0EQr4gg.js","sources":["../../components/features/SnippetVault.tsx"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport { LockClosedIcon, SparklesIcon, TrashIcon, ClipboardDocumentIcon, ArrowDownTrayIcon } from '../icons.tsx';\nimport { useLocalStorage } from '../../hooks/useLocalStorage.ts';\nimport { enhanceSnippetStream, generateTagsForCode } from '../../services/aiService.ts';\nimport { LoadingSpinner } from '../shared/index.tsx';\nimport { downloadFile } from '../../services/fileUtils.ts';\nimport { useNotification } from '../../contexts/NotificationContext.tsx';\n\ninterface Snippet {\n    id: number; name: string; code: string; language: string; tags: string[];\n}\n\nconst langToExt: Record<string, string> = {\n    javascript: 'js',\n    typescript: 'ts',\n    python: 'py',\n    css: 'css',\n    html: 'html',\n    json: 'json',\n    markdown: 'md',\n    plaintext: 'txt',\n};\n\nexport const SnippetVault: React.FC = () => {\n    const [snippets, setSnippets] = useLocalStorage<Snippet[]>('devcore_snippets', [{ id: 1, name: 'React Hook Boilerplate', language: 'javascript', code: `import { useState } from 'react';\\n\\nconst useCustomHook = () => {\\n  const [value, setValue] = useState(null);\\n  return { value, setValue };\\n};`, tags: ['react', 'hook'] }]);\n    const [activeSnippet, setActiveSnippet] = useState<Snippet | null>(null);\n    const [isEnhancing, setIsEnhancing] = useState(false);\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isEditingName, setIsEditingName] = useState(false);\n    const { addNotification } = useNotification();\n\n    const filteredSnippets = useMemo(() => {\n        if (!searchTerm) return snippets;\n        const lowerSearch = searchTerm.toLowerCase();\n        return snippets.filter((s: Snippet) => \n            s.name.toLowerCase().includes(lowerSearch) || \n            s.code.toLowerCase().includes(lowerSearch) ||\n            (s.tags && s.tags.some(t => t.toLowerCase().includes(lowerSearch)))\n        );\n    }, [snippets, searchTerm]);\n\n    useEffect(() => {\n        if (!activeSnippet && filteredSnippets.length > 0) setActiveSnippet(filteredSnippets[0]);\n        if (activeSnippet) setActiveSnippet(snippets.find((s: Snippet) => s.id === activeSnippet.id) || null);\n    }, [snippets, activeSnippet, filteredSnippets]);\n\n    const updateSnippet = (snippet: Snippet) => {\n        setSnippets(snippets.map((s: Snippet) => s.id === snippet.id ? snippet : s));\n        setActiveSnippet(snippet);\n    };\n\n    const handleEnhance = async () => {\n        if (!activeSnippet) return;\n        setIsEnhancing(true);\n        try {\n            const stream = enhanceSnippetStream(activeSnippet.code);\n            let fullResponse = '';\n            for await (const chunk of stream) {\n                fullResponse += chunk;\n                updateSnippet({ ...activeSnippet, code: fullResponse.replace(/^```(?:\\w+\\n)?/, '').replace(/```$/, '') });\n            }\n        } finally { setIsEnhancing(false); }\n    };\n    \n    const handleAiTagging = async (snippet: Snippet) => {\n        if (!snippet.code.trim()) return;\n        try {\n            const suggestedTags = await generateTagsForCode(snippet.code);\n            const newTags = [...new Set([...(snippet.tags || []), ...suggestedTags])];\n            updateSnippet({...snippet, tags: newTags});\n            addNotification('AI tags added!', 'success');\n        } catch(e) {\n            console.error(\"AI tagging failed:\", e);\n            addNotification('AI tagging failed.', 'error');\n        }\n    };\n\n    const handleAddNew = () => {\n        const newSnippet: Snippet = { id: Date.now(), name: 'New Snippet', language: 'plaintext', code: '', tags: [] };\n        setSnippets([...snippets, newSnippet]);\n        setActiveSnippet(newSnippet);\n    };\n    \n    const handleDelete = (id: number) => {\n        setSnippets(snippets.filter((s: Snippet) => s.id !== id));\n        if(activeSnippet?.id === id) setActiveSnippet(filteredSnippets.length > 1 ? filteredSnippets[0] : null);\n    };\n    \n    const handleDownload = () => {\n        if(!activeSnippet) return;\n        const extension = langToExt[activeSnippet.language] || 'txt';\n        const filename = `${activeSnippet.name.replace(/\\s/g, '_')}.${extension}`;\n        downloadFile(activeSnippet.code, filename);\n    }\n\n    const handleNameChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        if (activeSnippet) updateSnippet({...activeSnippet, name: e.target.value});\n    };\n    \n    const handleTagsChange = (e: React.KeyboardEvent<HTMLInputElement>) => {\n        if (e.key === 'Enter' && activeSnippet) {\n            const newTag = e.currentTarget.value.trim();\n            if (newTag && !activeSnippet.tags.includes(newTag)) {\n                updateSnippet({...activeSnippet, tags: [...(activeSnippet.tags ?? []), newTag]});\n            }\n            e.currentTarget.value = '';\n        }\n    };\n\n    return (\n        <div className=\"h-full flex flex-col p-4 sm:p-6 lg:p-8 text-text-primary\">\n            <header className=\"mb-6\"><h1 className=\"text-3xl font-bold flex items-center\"><LockClosedIcon /><span className=\"ml-3\">Snippet Vault</span></h1><p className=\"text-text-secondary mt-1\">Store, search, tag, and enhance your reusable code snippets with AI.</p></header>\n            <div className=\"flex-grow flex gap-6 min-h-0\">\n                <aside className=\"w-1/3 bg-surface border border-border p-4 rounded-lg flex flex-col\">\n                    <input type=\"text\" placeholder=\"Search snippets...\" value={searchTerm} onChange={e => setSearchTerm(e.target.value)} className=\"w-full px-3 py-1.5 mb-3 rounded-md bg-background border border-border text-sm\"/>\n                    <ul className=\"space-y-2 flex-grow overflow-y-auto pr-2\">{filteredSnippets.map((s: Snippet) => (<li key={s.id} className=\"group flex items-center justify-between\"><button onClick={() => setActiveSnippet(s)} className={`w-full text-left px-3 py-2 rounded-md ${activeSnippet?.id === s.id ? 'bg-primary/10 text-primary' : 'hover:bg-gray-100 dark:hover:bg-slate-700'}`}>{s.name}</button><div className=\"flex opacity-0 group-hover:opacity-100 transition-opacity\"><button onClick={() => {navigator.clipboard.writeText(s.code); addNotification(\"Copied snippet!\", \"success\")}} className=\"ml-2 p-1 text-text-secondary hover:text-primary\" title=\"Copy\"><ClipboardDocumentIcon /></button><button onClick={() => handleDelete(s.id)} className=\"ml-2 p-1 text-text-secondary hover:text-red-500\" title=\"Delete\"><TrashIcon/></button></div></li>))}</ul>\n                    <div className=\"mt-4 pt-4 border-t border-border\"><button onClick={handleAddNew} className=\"btn-primary w-full text-sm py-2\">Add New Snippet</button></div>\n                </aside>\n                <main className=\"w-2/3 flex flex-col\">\n                    {activeSnippet ? (<>\n                        <div className=\"flex justify-between items-center mb-2\">\n                            {isEditingName ? <input type=\"text\" value={activeSnippet.name} onChange={handleNameChange} onBlur={() => setIsEditingName(false)} autoFocus className=\"text-lg font-bold bg-gray-100 dark:bg-slate-700 rounded px-2\"/> : <h3 onDoubleClick={() => setIsEditingName(true)} className=\"text-lg font-bold cursor-pointer\">{activeSnippet.name}</h3>}\n                            <div className=\"flex gap-2\">\n                                <button onClick={() => handleAiTagging(activeSnippet)} className=\"flex items-center gap-2 px-3 py-1 bg-teal-500/80 text-white font-bold text-xs rounded-md\"><SparklesIcon /> AI Tag</button>\n                                <button onClick={handleEnhance} disabled={isEnhancing} className=\"flex items-center gap-2 px-3 py-1 bg-purple-500/80 text-white font-bold text-xs rounded-md disabled:bg-gray-400\"><SparklesIcon /> AI Enhance</button>\n                                <button onClick={handleDownload} className=\"flex items-center gap-1 px-3 py-1 bg-gray-100 dark:bg-slate-700 text-xs rounded-md\"><ArrowDownTrayIcon className=\"w-4 h-4\"/> Download</button>\n                            </div>\n                        </div>\n                        <textarea value={activeSnippet.code} onChange={e => updateSnippet({...activeSnippet, code: e.target.value})} className=\"flex-grow p-4 bg-surface border border-border rounded-md resize-none font-mono text-sm focus:ring-2 focus:ring-primary focus:outline-none\"/>\n                        <div className=\"mt-2 text-xs text-text-secondary\">\n                           <div className=\"flex items-center gap-2 flex-wrap\">\n                             <span className=\"font-bold\">Tags:</span> {(activeSnippet.tags ?? []).map(t => <span key={t} className=\"bg-gray-200 dark:bg-slate-700 px-2 py-0.5 rounded-full\">{t}</span>)}\n                             <input type=\"text\" placeholder=\"+ Add tag\" onKeyDown={handleTagsChange} className=\"bg-transparent border-b border-border focus:outline-none focus:border-primary w-24 text-xs px-1\"/>\n                           </div>\n                        </div>\n                    </>) : (<div className=\"flex-grow flex items-center justify-center bg-background border border-border rounded-lg text-text-secondary\">Select a snippet or create a new one.</div>)}\n                </main>\n            </div>\n        </div>\n    );\n};"],"names":["langToExt","SnippetVault","snippets","setSnippets","useLocalStorage","activeSnippet","setActiveSnippet","useState","isEnhancing","setIsEnhancing","searchTerm","setSearchTerm","isEditingName","setIsEditingName","addNotification","useNotification","filteredSnippets","useMemo","lowerSearch","s","t","useEffect","updateSnippet","snippet","handleEnhance","stream","enhanceSnippetStream","fullResponse","chunk","handleAiTagging","suggestedTags","generateTagsForCode","newTags","e","handleAddNew","newSnippet","handleDelete","id","handleDownload","extension","filename","downloadFile","handleNameChange","handleTagsChange","newTag","jsxs","jsx","LockClosedIcon","ClipboardDocumentIcon","TrashIcon","Fragment","SparklesIcon","ArrowDownTrayIcon"],"mappings":"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"}
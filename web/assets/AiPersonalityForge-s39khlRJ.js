import{r as m,j as e}from"./react-CIdJ77ke.js";import{a as P,T as O,am as A,ar as E,J as T,M as F,L as R,as as D}from"./index-CIRHoGv6.js";import{u as J,f as M}from"./promptUtils-DQORJphX.js";import{e as U}from"./fileUtils-DLahR3l0.js";import"./db-DoDjOlgE.js";import"./accessibilityService-CxnTg-sn.js";import"./workspaceConnectorService-DpOCHZ2y.js";import"./@braintree-DzxiOROe.js";import"./react-dom-R9L8nDNe.js";import"./scheduler-CoSDG3-6.js";import"./@google-dIZ1hAme.js";import"./idb-Dob3nYDb.js";import"./marked-BrGMJkBT.js";import"./mermaid-BKUgZdUC.js";import"./dayjs-CeEF-NGT.js";import"./d3-transition-CiCB8KJE.js";import"./d3-timer-DdKHrDhs.js";import"./d3-dispatch-kxCwF96_.js";import"./d3-interpolate-CtIaNujU.js";import"./d3-color-amxIadob.js";import"./d3-selection-C52G7wmG.js";import"./d3-ease-DRPgKoYJ.js";import"./d3-zoom-BYoC3mS3.js";import"./dompurify-J5RlrwSC.js";import"./dagre-d3-es-CTpFWynZ.js";import"./lodash-es-Dt6r0yiR.js";import"./d3-shape-CX8xTzfR.js";import"./d3-path-CimkQT29.js";import"./d3-fetch-BOsq7VnW.js";import"./khroma-DUX6PT6k.js";import"./uuid-DhYbOkY1.js";import"./d3-scale-DRZz3QW5.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-DGRYoJHh.js";import"./d3-format-CzD4bSOQ.js";import"./d3-time-format-CUNN4Ell.js";import"./d3-time-6cSPyVSY.js";import"./d3-axis-DSWTncID.js";import"./elkjs-oKFFZvz7.js";import"./cytoscape-DtBltrT8.js";import"./cytoscape-cose-bilkent-Cgr1thlj.js";import"./cose-base-CwCxnKwh.js";import"./layout-base-CMXQqlmj.js";import"./d3-sankey-DgqkLiUE.js";import"./d3-scale-chromatic-B-NsZVaP.js";import"./ts-dedent-DrFu-skq.js";import"./stylis-D5iaQeiq.js";import"./mdast-util-from-markdown-CLAsVoWb.js";import"./micromark-CTBPIv-_.js";import"./micromark-util-combine-extensions-Bka6Sc1c.js";import"./micromark-util-chunked-DrRIdSP-.js";import"./micromark-factory-space-x2vfxbz5.js";import"./micromark-util-character-Bcm1tP9o.js";import"./micromark-core-commonmark-AH8VCgT7.js";import"./micromark-util-classify-character-Cq7Fg3xE.js";import"./micromark-util-resolve-all-PQCKh0dx.js";import"./decode-named-character-reference-C3-224fz.js";import"./micromark-util-subtokenize-QwsxNXk2.js";import"./micromark-factory-destination-CypD_wgM.js";import"./micromark-factory-label-CRHH4ZHP.js";import"./micromark-factory-title-B7kCBvC9.js";import"./micromark-factory-whitespace-B322EA6O.js";import"./micromark-util-normalize-identifier-C9ANKk3v.js";import"./micromark-util-html-tag-name-DbKNfynz.js";import"./micromark-util-decode-numeric-character-reference-DRnCnno4.js";import"./micromark-util-decode-string-DJl8Y_PO.js";import"./unist-util-stringify-position-Ch_qCilz.js";import"./mdast-util-to-string-C_aolqmU.js";import"./jszip-CFFhfFtd.js";import"./octokit-B6bKu3NB.js";import"./@octokit-MBEWYTsi.js";import"./bottleneck-D_vuF9V7.js";import"./universal-user-agent-CLgqIJsR.js";import"./before-after-hook-y8XtM9xW.js";import"./fast-content-type-parse-3SwieiST.js";import"./axe-core-NFfJ1iTt.js";const $={persona:"You are a helpful assistant.",rules:[],outputFormat:"markdown",exampleIO:[]},lt=()=>{const[n,u]=J(),[c,p]=m.useState(null),{addNotification:x}=P(),b=m.useRef(null),[f,j]=m.useState(""),[y,h]=m.useState([]),[g,N]=m.useState(!1),o=n.find(t=>t.id===c);m.useEffect(()=>{!c&&n.length>0&&p(n[0].id)},[n,c]);const l=(t,r)=>{if(!o)return;const i={...o,[t]:r};u(n.map(a=>a.id===c?i:a))},I=()=>{const t=Date.now().toString(),r={...$,id:t,name:"Untitled Personality"};u([...n,r]),p(t)},k=t=>{window.confirm("Are you sure you want to delete this personality?")&&(u(n.filter(r=>r.id!==t)),c===t&&p(n.length>1?n[0].id:null))},v=async()=>{if(!f.trim()||!o||g)return;const t=M(o),r=[...y,{role:"user",content:f}];h(r),j(""),N(!0);try{const i=D(f,t,.7);let a="";h(s=>[...s,{role:"model",content:""}]);for await(const s of i)a+=s,h(d=>d[d.length-1].role==="model"?[...d.slice(0,-1),{role:"model",content:a}]:d)}catch(i){const a=i instanceof Error?i.message:"An error occurred";h(s=>[...s,{role:"model",content:`**Error:** ${a}`}])}finally{N(!1)}},C=()=>{o&&(U(o,`${o.name.replace(/\s+/g,"_")}.json`),x("Personality exported!","success"))},S=t=>{const r=t.target.files?.[0];if(!r)return;const i=new FileReader;i.onload=a=>{try{const s=JSON.parse(a.target?.result);s.id&&s.name&&s.persona?(u(d=>[...d.filter(w=>w.id!==s.id),s]),p(s.id),x("Personality imported!","success")):x("Invalid personality file.","error")}catch{x("Failed to parse JSON file.","error")}},i.readAsText(r)};return e.jsxs("div",{className:"h-full flex text-text-primary",children:[e.jsxs("aside",{className:"w-64 bg-surface border-r border-border flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsx("h2",{className:"text-lg font-bold",children:"Personalities"})}),e.jsx("div",{className:"flex-grow overflow-y-auto",children:n.map(t=>e.jsxs("div",{onClick:()=>p(t.id),className:`group flex justify-between items-center p-3 text-sm cursor-pointer ${c===t.id?"bg-primary/10 text-primary":"hover:bg-gray-100 dark:hover:bg-slate-700"}`,children:[e.jsx("span",{className:"truncate",children:t.name}),e.jsx("button",{onClick:r=>{r.stopPropagation(),k(t.id)},className:"opacity-0 group-hover:opacity-100 text-text-secondary hover:text-red-500",children:e.jsx(O,{})})]},t.id))}),e.jsxs("div",{className:"p-4 border-t border-border space-y-2",children:[e.jsxs("button",{onClick:I,className:"btn-primary w-full py-2 text-sm flex items-center justify-center gap-2",children:[e.jsx(A,{})," New"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>b.current?.click(),className:"flex-1 py-2 text-sm bg-gray-100 dark:bg-slate-700 rounded-md flex items-center justify-center gap-2",children:[e.jsx(E,{})," Import"]}),e.jsxs("button",{onClick:C,className:"flex-1 py-2 text-sm bg-gray-100 dark:bg-slate-700 rounded-md flex items-center justify-center gap-2",children:[e.jsx(T,{})," Export"]}),e.jsx("input",{type:"file",ref:b,onChange:S,accept:".json",className:"hidden"})]})]})]}),o?e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-px bg-border",children:[e.jsxs("div",{className:"bg-background p-4 flex flex-col gap-4 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-bold",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:t=>l("name",t.target.value),className:"w-full mt-1 p-2 bg-surface border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-bold",children:"Persona"}),e.jsx("textarea",{value:o.persona,onChange:t=>l("persona",t.target.value),className:"w-full mt-1 p-2 bg-surface border rounded h-24"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-bold",children:"Rules (one per line)"}),e.jsx("textarea",{value:o.rules.join(`
`),onChange:t=>l("rules",t.target.value.split(`
`)),className:"w-full mt-1 p-2 bg-surface border rounded h-32"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-bold",children:"Output Format"}),e.jsxs("select",{value:o.outputFormat,onChange:t=>l("outputFormat",t.target.value),className:"w-full mt-1 p-2 bg-surface border rounded",children:[e.jsx("option",{children:"markdown"}),e.jsx("option",{children:"json"}),e.jsx("option",{children:"text"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold mb-2",children:"Examples"}),o.exampleIO.map((t,r)=>e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2 p-2 border rounded bg-surface",children:[e.jsx("textarea",{placeholder:"User Input",value:t.input,onChange:i=>l("exampleIO",o.exampleIO.map((a,s)=>s===r?{...a,input:i.target.value}:a)),className:"h-20 p-1 bg-background border rounded"}),e.jsx("textarea",{placeholder:"Model Output",value:t.output,onChange:i=>l("exampleIO",o.exampleIO.map((a,s)=>s===r?{...a,output:i.target.value}:a)),className:"h-20 p-1 bg-background border rounded"})]},r)),e.jsx("button",{onClick:()=>l("exampleIO",[...o.exampleIO,{input:"",output:""}]),className:"text-sm text-primary",children:"+ Add Example"})]})]}),e.jsxs("div",{className:"bg-background p-4 flex flex-col",children:[e.jsx("h2",{className:"text-lg font-bold mb-2 border-b pb-2",children:"Live Testbed"}),e.jsxs("div",{className:"flex-grow overflow-y-auto space-y-4 pr-2",children:[y.map((t,r)=>e.jsxs("div",{className:`p-3 rounded-lg ${t.role==="user"?"bg-primary/10":"bg-surface"}`,children:[e.jsx("strong",{className:"capitalize",children:t.role}),e.jsx(F,{content:t.content})]},r)),g&&e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{})})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("input",{value:f,onChange:t=>j(t.target.value),onKeyDown:t=>t.key==="Enter"&&v(),className:"flex-grow p-2 bg-surface border rounded",placeholder:"Test your AI..."}),e.jsx("button",{onClick:v,disabled:g,className:"btn-primary px-4",children:"Send"})]})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-text-secondary",children:"Select or create a personality to begin."})]})};export{lt as AiPersonalityForge};
//# sourceMappingURL=AiPersonalityForge-s39khlRJ.js.map

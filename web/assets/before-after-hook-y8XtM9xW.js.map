// Copyright James Burvel Oâ€™Callaghan III
// President Citibank Demo Business Inc.

{"version":3,"file":"before-after-hook-y8XtM9xW.js","sources":["../../node_modules/before-after-hook/lib/register.js","../../node_modules/before-after-hook/lib/add.js","../../node_modules/before-after-hook/lib/remove.js","../../node_modules/before-after-hook/index.js"],"sourcesContent":["// @ts-check\n\nexport function register(state, name, method, options) {\n  if (typeof method !== \"function\") {\n    throw new Error(\"method for before hook must be a function\");\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  if (Array.isArray(name)) {\n    return name.reverse().reduce((callback, name) => {\n      return register.bind(null, state, name, callback, options);\n    }, method)();\n  }\n\n  return Promise.resolve().then(() => {\n    if (!state.registry[name]) {\n      return method(options);\n    }\n\n    return state.registry[name].reduce((method, registered) => {\n      return registered.hook.bind(null, method, options);\n    }, method)();\n  });\n}\n","// @ts-check\n\nexport function addHook(state, kind, name, hook) {\n  const orig = hook;\n  if (!state.registry[name]) {\n    state.registry[name] = [];\n  }\n\n  if (kind === \"before\") {\n    hook = (method, options) => {\n      return Promise.resolve()\n        .then(orig.bind(null, options))\n        .then(method.bind(null, options));\n    };\n  }\n\n  if (kind === \"after\") {\n    hook = (method, options) => {\n      let result;\n      return Promise.resolve()\n        .then(method.bind(null, options))\n        .then((result_) => {\n          result = result_;\n          return orig(result, options);\n        })\n        .then(() => {\n          return result;\n        });\n    };\n  }\n\n  if (kind === \"error\") {\n    hook = (method, options) => {\n      return Promise.resolve()\n        .then(method.bind(null, options))\n        .catch((error) => {\n          return orig(error, options);\n        });\n    };\n  }\n\n  state.registry[name].push({\n    hook: hook,\n    orig: orig,\n  });\n}\n","// @ts-check\n\nexport function removeHook(state, name, method) {\n  if (!state.registry[name]) {\n    return;\n  }\n\n  const index = state.registry[name]\n    .map((registered) => {\n      return registered.orig;\n    })\n    .indexOf(method);\n\n  if (index === -1) {\n    return;\n  }\n\n  state.registry[name].splice(index, 1);\n}\n","// @ts-check\n\nimport { register } from \"./lib/register.js\";\nimport { addHook } from \"./lib/add.js\";\nimport { removeHook } from \"./lib/remove.js\";\n\n// bind with array of arguments: https://stackoverflow.com/a/21792913\nconst bind = Function.bind;\nconst bindable = bind.bind(bind);\n\nfunction bindApi(hook, state, name) {\n  const removeHookRef = bindable(removeHook, null).apply(\n    null,\n    name ? [state, name] : [state]\n  );\n  hook.api = { remove: removeHookRef };\n  hook.remove = removeHookRef;\n  [\"before\", \"error\", \"after\", \"wrap\"].forEach((kind) => {\n    const args = name ? [state, kind, name] : [state, kind];\n    hook[kind] = hook.api[kind] = bindable(addHook, null).apply(null, args);\n  });\n}\n\nfunction Singular() {\n  const singularHookName = Symbol(\"Singular\");\n  const singularHookState = {\n    registry: {},\n  };\n  const singularHook = register.bind(null, singularHookState, singularHookName);\n  bindApi(singularHook, singularHookState, singularHookName);\n  return singularHook;\n}\n\nfunction Collection() {\n  const state = {\n    registry: {},\n  };\n\n  const hook = register.bind(null, state);\n  bindApi(hook, state);\n\n  return hook;\n}\n\nexport default { Singular, Collection };\n"],"names":["register","state","name","method","options","callback","registered","addHook","kind","hook","orig","result","result_","error","removeHook","index","bind","bindable","bindApi","removeHookRef","args","Collection","Hook"],"mappings":"AAEO,SAASA,EAASC,EAAOC,EAAMC,EAAQC,EAAS,CACrD,GAAI,OAAOD,GAAW,WACpB,MAAM,IAAI,MAAM,2CAA2C,EAO7D,OAJKC,IACHA,EAAU,CAAA,GAGR,MAAM,QAAQF,CAAI,EACbA,EAAK,QAAO,EAAG,OAAO,CAACG,EAAUH,IAC/BF,EAAS,KAAK,KAAMC,EAAOC,EAAMG,EAAUD,CAAO,EACxDD,CAAM,EAAC,EAGL,QAAQ,UAAU,KAAK,IACvBF,EAAM,SAASC,CAAI,EAIjBD,EAAM,SAASC,CAAI,EAAE,OAAO,CAACC,EAAQG,IACnCA,EAAW,KAAK,KAAK,KAAMH,EAAQC,CAAO,EAChDD,CAAM,EAAC,EALDA,EAAOC,CAAO,CAMxB,CACH,CCxBO,SAASG,EAAQN,EAAOO,EAAMN,EAAMO,EAAM,CAC/C,MAAMC,EAAOD,EACRR,EAAM,SAASC,CAAI,IACtBD,EAAM,SAASC,CAAI,EAAI,CAAA,GAGrBM,IAAS,WACXC,EAAO,CAACN,EAAQC,IACP,QAAQ,QAAO,EACnB,KAAKM,EAAK,KAAK,KAAMN,CAAO,CAAC,EAC7B,KAAKD,EAAO,KAAK,KAAMC,CAAO,CAAC,GAIlCI,IAAS,UACXC,EAAO,CAACN,EAAQC,IAAY,CAC1B,IAAIO,EACJ,OAAO,QAAQ,QAAO,EACnB,KAAKR,EAAO,KAAK,KAAMC,CAAO,CAAC,EAC/B,KAAMQ,IACLD,EAASC,EACFF,EAAKC,EAAQP,CAAO,EAC5B,EACA,KAAK,IACGO,CACR,CACL,GAGEH,IAAS,UACXC,EAAO,CAACN,EAAQC,IACP,QAAQ,QAAO,EACnB,KAAKD,EAAO,KAAK,KAAMC,CAAO,CAAC,EAC/B,MAAOS,GACCH,EAAKG,EAAOT,CAAO,CAC3B,GAIPH,EAAM,SAASC,CAAI,EAAE,KAAK,CACxB,KAAMO,EACN,KAAMC,CACV,CAAG,CACH,CC3CO,SAASI,EAAWb,EAAOC,EAAMC,EAAQ,CAC9C,GAAI,CAACF,EAAM,SAASC,CAAI,EACtB,OAGF,MAAMa,EAAQd,EAAM,SAASC,CAAI,EAC9B,IAAKI,GACGA,EAAW,IACnB,EACA,QAAQH,CAAM,EAEbY,IAAU,IAIdd,EAAM,SAASC,CAAI,EAAE,OAAOa,EAAO,CAAC,CACtC,CCXA,MAAMC,EAAO,SAAS,KAChBC,EAAWD,EAAK,KAAKA,CAAI,EAE/B,SAASE,EAAQT,EAAMR,EAAOC,EAAM,CAClC,MAAMiB,EAAgBF,EAASH,EAAY,IAAI,EAAE,MAC/C,KACuB,CAACb,CAAK,CACjC,EACEQ,EAAK,IAAM,CAAE,OAAQU,CAAa,EAClCV,EAAK,OAASU,EACd,CAAC,SAAU,QAAS,QAAS,MAAM,EAAE,QAASX,GAAS,CACrD,MAAMY,EAAoC,CAACnB,EAAOO,CAAI,EACtDC,EAAKD,CAAI,EAAIC,EAAK,IAAID,CAAI,EAAIS,EAASV,EAAS,IAAI,EAAE,MAAM,KAAMa,CAAI,CACxE,CAAC,CACH,CAYA,SAASC,GAAa,CACpB,MAAMpB,EAAQ,CACZ,SAAU,CAAA,CACd,EAEQQ,EAAOT,EAAS,KAAK,KAAMC,CAAK,EACtC,OAAAiB,EAAQT,EAAMR,CAAK,EAEZQ,CACT,CAEA,MAAAa,EAAe,CAAY,WAAAD,CAAU","x_google_ignoreList":[0,1,2,3]}